---
#  raw: cat /etc/issue.net | grep '{{ bootstrap_versions }}'

- name: Bootstrap | Check if bootstrap is needed
  raw: dpkg -l {{ item }}
  register: need_bootstrap
  failed_when: false
  changed_when: false
  with_items:
    - python-minimal
    - python-pip
    - dbus
  tags: facts

- name: Bootstrap | Install python 2.x, pip, and dbus
  raw:
    apt-get update && \
    apt-get install -y {{ item | map(atribute='item') | join(' ') }}
  environment:
    DEBIAN_FRONTEND: noninteractive
  with_items:
    - ["{{ need_bootstrap.results | selectattr('rc') }}"]
  when: item

- set_fact:
    ansible_python_interpreter: "/usr/bin/python"
  tags: facts
